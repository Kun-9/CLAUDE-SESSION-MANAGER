---
name: todo
description: 프로젝트 TODO를 관리합니다.
---

# 프로젝트 TODO 관리

`.claude/todo/todo.md` 파일로 프로젝트 할 일을 관리합니다.

## 인자가 없을 때 (`/todo`)

1. `.claude/todo/todo.md` 파일을 읽습니다
2. 각 TODO를 한 줄로 요약합니다:
   - 미완료: `[ ] 항목명 (비용/영향도)`
   - 작업 완료 (확인 대기): `[x] 항목명 ⏳`
   - 확인 완료: `[x] ✅ 항목명`
3. AskUserQuestion으로 선택지 제공:
   - 각 미완료 TODO 항목 → 선택 시 구현 진행
   - "확인 대기 항목 검토" → 작업 완료되었지만 사용자 확인이 안 된 항목들 표시
   - "구현 검증" → 완료 항목들의 실제 구현 여부 확인
   - "새 TODO 추가"

사용자가 TODO를 선택하면 해당 기능 구현을 시작하세요.

### 확인 대기 항목 검토 시

작업 완료(`[x]`)되었지만 확인 완료(`✅`)가 없는 항목들을 나열합니다.
사용자가 항목을 선택하면:
1. 해당 항목의 `해결:` 내용을 보여줌
2. 관련 파일 변경사항 요약
3. AskUserQuestion으로 선택지 제공:
   - "확인 완료" → `✅` 마크 추가 + `확인일:` 기록
   - "재작업 필요" → `[x]` → `[ ]`로 변경, 피드백 기록
   - "다음 항목"

## 구현 시작 전 필수 사항

**CLAUDE.md 숙지 필수**: TODO 작업을 시작하기 전에 반드시 프로젝트의 `CLAUDE.md` 파일을 다시 읽고 규칙을 숙지하세요.

특히 다음 원칙을 강조합니다:

1. **모듈화**: 새 기능은 기존 아키텍처 패턴(Store/Service/ViewModel)에 맞게 분리
2. **재사용성**: 이미 존재하는 컴포넌트나 유틸리티가 있는지 먼저 확인하고 활용
3. **단일 책임**: 각 타입은 하나의 역할만 담당 (View는 UI만, Service는 로직만)
4. **기존 패턴 준수**: 새 코드는 기존 코드베이스의 스타일과 패턴을 따름

## 인자가 있을 때 (`/todo add <내용>`)

1. 먼저 `.claude/todo/todo.md` 파일을 읽어 기존 항목 확인
2. 입력을 분석하여 개별 항목으로 분리 (쉼표, 줄바꿈 등)
3. **관련 항목 감지 및 계층화 판단**:
   - 추가할 항목들이 3개 이상이고 동일 기능/컴포넌트 대상인 경우:
     - 부모 항목을 생성하고 하위 항목으로 묶음
     - 예: "마크다운 개선 - 라이브러리, 하이라이팅, 표" → 부모 + 3개 자식
   - 기존 항목과 관련 파일이 70% 이상 겹치는 경우:
     - AskUserQuestion으로 선택지 제공:
       - "기존 항목의 하위로 추가" - 계층 구조로 편입
       - "독립 항목으로 추가" - 별도 항목으로 추가
       - "건너뛰기" - 추가 취소
4. **중복/유사 항목 검사** (각 항목에 대해):
   - 동일한 제목의 항목이 있는지 확인
   - 유사한 내용(키워드 70% 이상 일치)의 항목이 있는지 확인
   - 중복/유사 항목 발견 시 → AskUserQuestion으로 선택지 제공:
     - "그래도 추가" - 새 항목으로 추가
     - "기존 항목에 병합" - 기존 항목 설명에 내용 추가
     - "건너뛰기" - 해당 항목 추가 취소
5. 각 항목에 대해:
   - 프로젝트 컨텍스트 고려하여 구체화
   - 비용: 아래 기준표 참고
   - 영향도: Low(단일 파일), Mid(여러 파일), High(아키텍처)
   - 관련 파일 경로 추정
6. 관련 항목끼리 그룹화 (UI, 설정, 버그 등)
7. `.claude/todo/todo.md`에 추가 (없으면 생성)

### 유사 항목 판단 기준

- **동일**: 제목이 완전히 같음 (대소문자 무시)
- **유사**: 다음 중 하나 이상 해당
  - 핵심 키워드가 70% 이상 겹침
  - 관련 파일이 동일
  - 같은 기능/컴포넌트를 대상으로 함

## 비용 산정 기준

**객관적 지표를 기반으로 산정합니다. 여러 조건 중 가장 높은 등급을 적용합니다.**

| 등급 | 변경 라인 | 작업 유형 | 예시 |
|------|----------|----------|------|
| **XS** | 1~5줄 | 속성/수정자 추가, 상수값 변경 | `.frame(alignment:)` 추가, 색상값 변경 |
| **S** | 5~20줄 | 단일 메서드 내 로직 수정, 기존 패턴 복사 적용 | 조건문 추가, 기존 컴포넌트에 파라미터 추가 |
| **M** | 20~100줄 | 새 메서드/뷰 추가, 여러 파일 수정 필요 | 새 ViewModifier 작성, Store에 CRUD 추가 |
| **L** | 100줄+ | 새 기능/모듈, 설계 검토 필요, 아키텍처 변경 | 새 Service 추가, 데이터 모델 구조 변경 |

**판단 체크리스트:**
- [ ] 새 파일 생성이 필요한가? → 최소 M
- [ ] 기존 로직 이해가 선행되어야 하는가? → +1등급
- [ ] 여러 파일 간 조율이 필요한가? → 최소 M
- [ ] 테스트/검증에 시간이 필요한가? → +1등급

## TODO 파일 형식

```markdown
# Project TODO

## 그룹명

- [ ] 항목 제목
  - 설명: 구체적 설명
  - 비용: S/M/L
  - 영향도: Low/Mid/High
  - 관련 파일: 경로들

- [x] 작업 완료된 항목 (사용자 확인 대기)
  - 완료일: YYYY-MM-DD
  - 해결: 어떻게 해결했는지

- [x] ✅ 사용자 확인 완료된 항목
  - 완료일: YYYY-MM-DD
  - 확인일: YYYY-MM-DD

- [ ] 부모 항목 (기능 단위)
  - 설명: 여러 하위 작업을 포함하는 기능
  - 비용: L (하위 합산)
  - 영향도: High
  - 하위 항목:
    - [ ] 자식 항목 1
      - 설명: 세부 작업 1
      - 비용: S
    - [x] 자식 항목 2 (작업 완료, 확인 대기)
      - 완료일: YYYY-MM-DD
    - [x] ✅ 자식 항목 3 (확인 완료)
      - 완료일: YYYY-MM-DD
      - 확인일: YYYY-MM-DD
```

### 계층형 TODO 규칙

1. **부모 항목**: 여러 관련 작업을 묶는 기능 단위
   - `하위 항목:` 필드 아래에 자식 항목 나열
   - 부모 비용 = 하위 항목 비용 합산 (또는 가장 큰 등급)
   - 부모 완료 = 모든 하위 항목 완료 시

2. **자식 항목**: 들여쓰기로 구분
   - 부모와 동일한 형식 (설명, 비용 등)
   - 독립적으로 완료 표시 가능

3. **계층 표시** (`/todo` 조회 시):
   ```
   [ ] 마크다운 렌더링 개선 (L/High) [0/3]
       [ ] 라이브러리 검토 (S)
       [x] 코드 하이라이팅 (M) ⏳
       [x] ✅ 표 렌더링 (M)
   ```

4. **언제 계층화하나?**
   - 동일 기능/컴포넌트 대상 작업이 3개 이상일 때
   - 작업 간 의존성이 있을 때 (순서대로 진행 필요)
   - 관련 파일이 70% 이상 겹칠 때

## 동시 수정 방지 (중요)

여러 Claude 세션에서 동시에 TODO 파일을 수정하면 덮어쓰기 문제가 발생할 수 있습니다.

### 상태 변경 전 필수 절차

TODO 항목의 상태를 변경(완료 표시, 내용 수정, 삭제 등)하기 **직전에** 반드시:

1. **파일 다시 읽기**: todo.md 파일을 다시 읽어 최신 상태 확인
2. **변경사항 비교**: 처음 읽었을 때와 내용이 다른지 확인
3. **충돌 시 처리**:
   - 변경사항이 감지되면 **수정을 중단**
   - 사용자에게 "다른 세션에서 TODO가 수정되었습니다. 다시 확인해주세요." 알림
   - AskUserQuestion으로 "새로고침 후 계속" 또는 "취소" 선택지 제공

### 충돌 감지 기준

다음 경우를 변경사항으로 간주:
- 항목의 작업 상태(`[ ]` ↔ `[x]`) 변경
- 항목의 확인 상태(`✅`) 변경
- 항목 추가/삭제
- 항목 내용(설명, 비용 등) 변경

### 상태 전이 규칙

```
[ ] 미완료
 ↓ (Claude가 구현 완료)
[x] 작업 완료 (확인 대기) ⏳
 ↓ (사용자가 확인 완료)
[x] ✅ 확인 완료

[x] 작업 완료 (확인 대기)
 ↓ (사용자가 재작업 요청)
[ ] 미완료 (피드백 추가)
```

- **작업 완료 표시**: Claude가 구현을 마치면 `[x]` + `완료일:` + `해결:` 기록
- **확인 완료 표시**: 사용자가 검토 후 승인하면 `✅` + `확인일:` 추가
- **재작업 요청**: 사용자가 문제 발견 시 `[ ]`로 되돌리고 피드백 기록

### 예시 플로우

```
1. /todo 실행 → todo.md 읽음 (스냅샷 A)
2. 사용자가 "버그 수정" 선택
3. 구현 완료, 상태 변경 시도
4. todo.md 다시 읽음 (스냅샷 B)
5. A ≠ B 이면:
   → "TODO 파일이 변경되었습니다. 다시 확인해주세요."
   → 사용자에게 선택지 제공
6. A = B 이면:
   → 정상적으로 상태 변경 진행
```
